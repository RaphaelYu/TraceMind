{
  "policy": {
    "id": "plant-monitor",
    "strategy": "pdl/v0",
    "params": {
      "arms": {
        "default": {
          "threshold": "75.0",
          "action_on_violation": "WRITE_BACK",
          "target_node": "ns=2;i=5001"
        }
      },
      "epsilon": "0.1",
      "evaluate": [
        {
          "type": "assignment",
          "target": "temp",
          "operator": ":=",
          "expression": "coalesce(values[\"ns=2;i=2\"], first_numeric(values))",
          "line": 9,
          "column": 3,
          "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
        },
        {
          "type": "if",
          "condition": "temp >= arms.active.threshold",
          "then": [
            {
              "type": "choose",
              "options": [
                {
                  "name": "exploit",
                  "expression": "action = arms.active.action_on_violation",
                  "probability": null,
                  "line": 12,
                  "column": 7,
                  "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
                },
                {
                  "name": "explore",
                  "expression": "random([\"NONE\",\"WRITE_BACK\",\"SHUTDOWN\"])",
                  "probability": "epsilon",
                  "line": 13,
                  "column": 7,
                  "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
                }
              ],
              "line": 11,
              "column": 5,
              "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
            }
          ],
          "else": [
            {
              "type": "assignment",
              "target": "action",
              "operator": "=",
              "expression": "\"NONE\"",
              "line": 15,
              "column": 5,
              "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
            }
          ],
          "line": 10,
          "column": 3,
          "filename": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
        }
      ],
      "emit": {
        "action": "action",
        "target_node": "arms.active.target_node",
        "value": "1",
        "reason": "{ temp: temp, threshold: arms.active.threshold }"
      }
    },
    "metadata": {
      "dsl": {
        "version": "pdl/v0",
        "source": "/media/working/src/TraceMind/examples/dsl/opcua/plant-monitor.pdl"
      }
    }
  }
}